SELECT
    c.NAME,
    COALESCE(SUM(p.PRICE), 0) AS TOTAL_EARNINGS
FROM
    CHARACTERS c
LEFT JOIN
    PURCHASES pr ON c.NAME = pr.ITEM
LEFT JOIN
    CHARACTERS p ON pr.ITEM = p.NAME
GROUP BY
    c.NAME
ORDER BY
    c.NAME;
